let langApp={dataTable:{},url:{},dict:{},csrf:null,isActive:null,searchText:null,get(){this.dataTable=$("#langTable").DataTable({processing:!0,serverSide:!0,searching:!1,stateSave:!0,language:{paginate:{next:'<img src="/vendor/translate/img/arrow.svg">',previous:'<img src="/vendor/translate/img/arrow.svg">'}},order:[[0,"desc"]],scrollX:!0,deferRender:!0,scrollCollapse:!0,scroller:!0,ajax:{url:langApp.url.get,data:function(t){t.isActive=langApp.isActive,t.search=langApp.searchText}},columns:[{data:"id",width:"24px"},{data:"flag",width:"26px",render:function(t,a,e,s){return'<img src="'+t+'">'}},{data:"index",width:"26px"},{data:"name",width:"100px"},{data:"is_active",width:"42px",render:function(t,a,e,s){return'<div class="badge badge-'+(t?"active":"not-active")+'"></div>'}},{data:"created_at",width:"60px"},{data:"updated_at",width:"60px"},{data:null,width:"48px",defaultContent:'<div class="dropdown dropdown-arrow"><div class="dropdown-toggle" data-toggle="dropdown"><a class="dropdown-toggle-arrow"></a></div><div class="dropdown-menu dropdown-menu-right dropdown-menu-edit"><div class="action action-edit"><div class="icon icon-edit"></div>'+langApp.dict.edit+'</div><div class="action action-delete"><div class="icon icon-delete"></div>'+langApp.dict.delete+"</div></div></div>"}],columnDefs:[{targets:6,orderable:!1},{targets:7,orderable:!1}]})},create(t){$.ajax({type:"POST",url:langApp.url.store,data:t,success:function(t){"success"===t.status?(langApp.dataTable.ajax.reload(),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})},error:function(t){$.notify({message:t.message},{type:"danger"})}})},update(t,a){$.ajax({type:"PATCH",url:langApp.url.update,data:t,success:function(t){"success"===t.status?(langApp.dataTable.ajax.reload(null,!1),a.modal("hide"),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})}})},delete(t){$.ajax({type:"DELETE",url:langApp.url.destroy,data:{id:t.data().id,_token:langApp.csrf},success:function(a){"success"===a.status?(t.remove().draw(!1),$.notify({message:a.message},{type:"success"})):$.notify({message:a.message},{type:"danger"})}})},init(){this.get(),$("#langCreateForm").on("submit",function(t){t.preventDefault(),langApp.create($(this).serializeArray())}),$("#langTable tbody").on("click","div.action-edit",function(){let t=langApp.dataTable.row($(this).parents("tr")).data();$('#langEditModal [name="id"]').val(t.id),$('#langEditModal [name="index"]').val(t.index),$('#langEditModal [name="name"]').val(t.name),$('#langEditModal [name="is_active"]').prop("checked",t.is_active),$("#langEditModal").modal()}),$("#langEditForm").on("submit",function(t){t.preventDefault(),langApp.update($(this).serializeArray(),$("#langEditModal"))}),$("#langTable tbody").on("click","div.action-delete",function(){let t=langApp.dataTable.row($(this).parents("tr"));langApp.delete(t)}),$("#statusOptions input").on("click",function(){langApp.isActive=$(this).val(),langApp.dataTable.draw()}),$("#langSearchForm").on("submit",function(t){t.preventDefault(),langApp.searchText=$(this).find("input").val(),langApp.dataTable.draw()}),$("#statusLink").on("click",function(t){t.preventDefault(),t.stopPropagation(),document.getElementById("statusOptions").classList.toggle("show-options")}),$("#statusOptions").on("click",function(t){t.stopPropagation()})}},groupApp={dataTable:{},url:{},dict:{},type:null,csrf:null,searchText:null,get(){this.dataTable=$("#groupTable").DataTable({processing:!0,serverSide:!0,searching:!1,stateSave:!0,language:{paginate:{next:'<img src="/vendor/translate/img/arrow.svg">',previous:'<img src="/vendor/translate/img/arrow.svg">'}},order:[[0,"desc"]],scrollX:!0,scrollY:!1,ajax:{url:groupApp.url.get,data:function(t){t.type=groupApp.type,t.search=groupApp.searchText}},columns:[{data:"id",width:"26px",render:function(t,a,e,s){return'<div class="action-link">'+t+"</div>"}},{data:"name",render:function(t,a,e,s){return'<div class="action-link">'+t+"</div>"}},{data:"trans",render:function(t,a,e,s){return'<div class="action-link">'+e.trans+" / "+e.not_trans+"</div>"}},{data:null,width:"48px",defaultContent:'<div class="dropdown dropdown-arrow"><div class="dropdown-toggle" data-toggle="dropdown"><a class="dropdown-toggle-arrow"></a></div><div class="dropdown-menu dropdown-menu-right dropdown-menu-edit"><div class="action action-restart"><div class="icon icon-restart"></div>'+groupApp.dict.restart+'</div><div class="action action-delete"><div class="icon icon-delete"></div>'+groupApp.dict.delete+"</div></div></div>"}],columnDefs:[{targets:2,orderable:!1},{targets:3,orderable:!1}]})},show(t){let a=t.data();window.location=groupApp.url.index+"?type="+a.type+"&group="+a.id},create(t){$.ajax({type:"POST",url:groupApp.url.store,data:t,success:function(t){"success"===t.status?(groupApp.dataTable.ajax.reload(),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})},error:function(t){$.notify({message:t.message},{type:"danger"})}})},restart(t){$.ajax({type:"POST",url:groupApp.url.restart,data:{group:t.data().id,_token:groupApp.csrf},success:function(t){"success"===t.status?(groupApp.dataTable.ajax.reload(),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})}})},import(){$.ajax({type:"GET",url:groupApp.url.import,data:{type:groupApp.type},success:function(t){if("success"===t.status){let a="";for(let e in t.items)a+='<tr class="'+(t.items[e].exists?"success":"")+'"><td>'+e+"</td><td>"+t.items[e].lang.join(", ")+'</td><td><input type="checkbox" class="form-control input-xs" name="group['+e+']" value="1"></td></tr>';$("#groupImportForm tbody").html(a),$("#groupImportModal").modal("show")}},error:function(t){$.notify({message:"Server error!"},{type:"danger"})}})},parse(t){$.ajax({type:"POST",url:groupApp.url.parse,data:t,success:function(t){"success"===t.status?(groupApp.dataTable.ajax.reload(),$("#groupImportModal").modal("hide"),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})},error:function(t){$.notify({message:"Server error!"},{type:"danger"})},complete:function(t){$("#groupImportForm .modal-footer button").prop("disabled",!1)}})},delete(t,a){$.ajax({type:"DELETE",url:groupApp.url.destroy,data:{id:t.data().id,trans:!0,_token:groupApp.csrf},success:function(a){"success"===a.status?(t.remove().draw(!1),$.notify({message:a.message},{type:"success"})):$.notify({message:a.message},{type:"danger"})}})},init(){this.get(),$("#groupCreateForm").on("submit",function(t){t.preventDefault(),groupApp.create($(this).serializeArray())}),$("#groupTable tbody").on("click","div.action-link",function(){let t=groupApp.dataTable.row($(this).parents("tr"));groupApp.show(t)}),$("#groupTable tbody").on("click","div.action-restart",function(){let t=groupApp.dataTable.row($(this).parents("tr"));groupApp.restart(t)}),$("#importGroup").on("click",function(){groupApp.import()}),$("#groupImportForm").on("submit",function(t){t.preventDefault(),$(this).find(".modal-footer button").prop("disabled",!0),groupApp.parse($(this).serializeArray())}),$("#groupTable tbody").on("click","div.action-delete",function(){let t=groupApp.dataTable.row($(this).parents("tr"));t.data().trans+t.data().not_trans>0?($("#groupDeleteModal").modal("show"),$('#groupDeleteModal button[type="submit"]').on("click",function(a){$("#groupDeleteModal").modal("hide"),groupApp.delete(t)})):groupApp.delete(t)}),$("#groupSearchForm").on("submit",function(t){t.preventDefault(),groupApp.searchText=$(this).find("input").val(),groupApp.dataTable.draw()})}},transApp={dataTable:{},url:{},dict:{},group:null,keyText:null,translationText:null,verified:null,translated:null,langs:{},get(){this.dataTable=$("#transTable").DataTable({processing:!0,serverSide:!0,searching:!1,stateSave:!0,language:{paginate:{next:'<img src="/vendor/translate/img/arrow.svg">',previous:'<img src="/vendor/translate/img/arrow.svg">'}},scrollX:200,order:[[0,"desc"]],ajax:{url:transApp.url.get,data:function(t){t.group_id=transApp.group,t.keyText=transApp.keyText,t.translationText=transApp.translationText,t.verified=transApp.verified,t.translated=transApp.translated,t.langs=Object.keys(transApp.langs)}},columns:transApp.columns(),drawCallback:function(t){$('[data-toggle="tooltip"]').tooltip()}})},create(t){$.ajax({type:"POST",url:transApp.url.store,data:t,success:function(t){"success"===t.status?(transApp.dataTable.ajax.reload(),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})},error:function(t){$.notify({message:t.message},{type:"danger"})}})},update(t,a){$.ajax({type:"PATCH",url:transApp.url.update,data:t,success:function(t){"success"===t.status?(transApp.dataTable.ajax.reload(null,!1),a.modal("hide"),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})}})},delete(t,a){$.ajax({type:"DELETE",url:transApp.url.destroy,data:t,success:function(t){"success"===t.status?(transApp.dataTable.ajax.reload(null,!1),a.modal("hide"),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})}})},columns(){let t=[];t.push({data:"key",title:"Key",width:"180px",render:function(t,a,e,s){return'<div class="form-control field key-field" >'+t+'</div> <div class="dropdown-toggle key" id="dropdownMenuButton" data-toggle="tooltip" title="'+e.description+'"></div>'}});for(let a in transApp.langs)t.push({data:"items._"+a,title:transApp.langs[a],width:"180px",orderable:!1,render:function(t,e,s,n){let r="",o="td-default";return t&&(r=t.translation||"",o=2===t.status?"td-aproved":1===t.status?"td-warning":"td-default"),'<div data-lang="'+a+'" class="translate form-control field '+o+'">'+r+"</div>"}});return t},init(){this.get(),$("#transCreateForm").on("submit",function(t){t.preventDefault(),transApp.create($(this).serializeArray())}),$("#transTable tbody").on("click",".dropdown-toggle",function(){let t=transApp.dataTable.row($(this).parents("tr")).data();$(this).hasClass("key")&&($('#keyEditForm [name="id"]').val(t.id),$('#keyEditForm [name="key"]').val(t.key),$('#keyEditForm [name="description"]').val(t.description),$("#keyEditModal").modal())}),$("#transTable tbody").on("click",".translate",function(){let t=transApp.dataTable.row($(this).parents("tr")).data(),a=$(this).data("lang"),e=t.items["_"+a]?t.items["_"+a].translation:"";$('#tranlateEditForm [name="key"]').val(t.id),$('#tranlateEditForm [name="lang"]').val(a),$('#tranlateEditForm [name="translation"]').val(e),$("#tranlateEditModal").modal()}),$('#keyEditForm button[type="submit"]').on("click",function(t){t.preventDefault(),transApp.update($(this).closest("form").serializeArray(),$("#keyEditModal"))}),$('#tranlateEditForm button[type="submit"]').on("click",function(t){t.preventDefault();let a=$(this).closest("form").serializeArray();a.push({name:"status",value:$(this).val()}),transApp.update(a,$("#tranlateEditModal"))}),$("#verifyOptions input").on("click",function(){transApp.verified=$(this).val(),transApp.dataTable.draw()}),$("#translateOptions input").on("click",function(){transApp.translated=$(this).val(),transApp.dataTable.draw()}),$("#langOptions input").on("click",function(){let t={};$("#langOptions input:checked").each(function(a,e){t[e.value]=transApp.langs[e.value]}),transApp.langs=0===Object.keys(t).length?transApp.langs:t,transApp.dataTable.clear().destroy(),$("#transTable tr").remove(),transApp.get()}),$("#searchFilter").on("submit",function(t){t.preventDefault(),transApp.keyText=$(this).find('[name="key"]').val(),transApp.translationText=$(this).find('[name="translation"]').val(),transApp.dataTable.draw()}),$(".accordion-header").on("click",function(t){t.preventDefault(),t.stopPropagation(),$(this).parent().find(".accordion-body").toggleClass("show-options")}),$("#searchLangFilter").on("keyup",function(t){let a=$("#langOptions .form-check"),e=this.value,s=e.charAt(0).toUpperCase()+e.slice(1);a.hide(),""!==e?a.each(function(t,a){($(a).data("lang").match(e+".*")||$(a).data("lang").match(s+".*"))&&$(a).show()}):a.show()})}};$(function(t){t('.modal-dialog button[name="cancel"]').on("click",function(){t(this).closest(".modal").modal("hide")})});