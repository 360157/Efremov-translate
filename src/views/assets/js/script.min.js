let langApp={dataTable:{},url:{},dict:{},isActive:null,searchText:null,get(){this.dataTable=$("#langTable").DataTable({processing:!0,serverSide:!0,searching:!1,stateSave:!0,order:[[0,"desc"]],scrollX:!0,deferRender:!0,scrollCollapse:!0,scroller:!0,ajax:{url:langApp.url.get,data:function(a){a.isActive=langApp.isActive,a.search=langApp.searchText}},columns:[{data:"id",width:"24px"},{data:"index",width:"26px"},{data:"name",width:"100px"},{data:"is_active",width:"42px",render:function(a,t,e,n){return'<div class="badge badge-'+(a?"active":"not-active")+'"></div>'}},{data:"created_at",width:"60px"},{data:"updated_at",width:"60px"},{data:null,width:"48px",defaultContent:'<div class="edit-wrapper"><div class="dropdown dropdown-arrow"><div class="dropdown-toggle" data-toggle="dropdown"><a class="dropdown-toggle-arrow"></a></div><div class="dropdown-menu dropdown-menu-right dropdown-menu-edit"><div class="action-edit"><div class="edit-icon"></div>'+langApp.dict.edit+'</div><div class="action-delete"><div class="delete-icon"></div>'+langApp.dict.delete+"</div></div></div></div>"}],columnDefs:[{targets:6,orderable:!1}]})},create(a){$.ajax({type:"POST",url:langApp.url.store,data:a,success:function(a){"success"===a.status?(langApp.dataTable.ajax.reload(),$.notify({message:a.message},{type:"success"})):$.notify({message:a.message},{type:"danger"})},error:function(a){$.notify({message:a.message},{type:"danger"})}})},update(a,t){$.ajax({type:"PATCH",url:langApp.url.update,data:a,success:function(a){"success"===a.status?(langApp.dataTable.ajax.reload(null,!1),t.modal("hide"),$.notify({message:a.message},{type:"success"})):$.notify({message:a.message},{type:"danger"})}})},delete(a){$.ajax({type:"DELETE",url:langApp.url.destroy,data:{id:a.data().id},success:function(t){"success"===t.status?(a.remove().draw(!1),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})}})},init(){this.get(),$("#langCreateForm").on("submit",function(a){a.preventDefault(),langApp.create($(this).serializeArray())}),$("#langTable tbody").on("click","div.action-edit",function(){let a=langApp.dataTable.row($(this).parents("tr")).data();$('#langEditModal [name="id"]').val(a.id),$('#langEditModal [name="index"]').val(a.index),$('#langEditModal [name="name"]').val(a.name),$('#langEditModal [name="is_active"]').prop("checked",a.is_active),$("#langEditModal").modal()}),$("#langEditForm").on("submit",function(a){a.preventDefault(),langApp.update($(this).serializeArray(),$("#langEditModal"))}),$("#langTable tbody").on("click","div.action-delete",function(){let a=langApp.dataTable.row($(this).parents("tr"));langApp.delete(a)}),$("#statusOptions input").on("click",function(){langApp.isActive=$(this).val(),langApp.dataTable.draw()}),$("#langSearchForm").on("submit",function(a){a.preventDefault(),langApp.searchText=$(this).find("input").val(),langApp.dataTable.draw()}),$("#statusLink").on("click",function(a){a.preventDefault(),a.stopPropagation(),document.getElementById("statusOptions").classList.toggle("show-options")}),$("#statusOptions").on("click",function(a){a.stopPropagation()})}},groupApp={dataTable:{},url:{},dict:{},type:null,csrf:null,searchText:null,get(){this.dataTable=$("#groupTable").DataTable({processing:!0,serverSide:!0,searching:!1,stateSave:!0,order:[[0,"desc"]],scrollX:!0,scrollY:!1,ajax:{url:groupApp.url.get,data:function(a){a.type=groupApp.type,a.search=groupApp.searchText}},columns:[{data:"id",width:"26px",render:function(a,t,e,n){return'<div class="action-link">'+a+"</div>"}},{data:"name",render:function(a,t,e,n){return'<div class="action-link">'+a+"</div>"}},{data:"trans",render:function(a,t,e,n){return'<div class="action-link">'+e.trans+" / "+e.not_trans+"</div>"}},{data:null,width:"48px",defaultContent:'<div class="edit-wrapper"><div class="dropdown dropdown-arrow"><div class="dropdown-toggle" data-toggle="dropdown"><a class="dropdown-toggle-arrow"></a></div><div class="dropdown-menu dropdown-menu-right dropdown-menu-edit"><div class="action-delete"><div class="delete-icon"></div>'+groupApp.dict.delete+"</div></div></div></div>"}],columnDefs:[{targets:2,orderable:!1},{targets:3,orderable:!1}]})},show(a){let t=a.data();window.location=groupApp.url.index+"?type="+t.type+"&group="+t.id},create(a){$.ajax({type:"POST",url:groupApp.url.store,data:a,success:function(a){"success"===a.status?(groupApp.dataTable.ajax.reload(),$.notify({message:a.message},{type:"success"})):$.notify({message:a.message},{type:"danger"})},error:function(a){$.notify({message:a.message},{type:"danger"})}})},delete(a,t){$.ajax({type:"DELETE",url:groupApp.url.destroy,data:{id:a.data().id,trans:!0,_token:groupApp.csrf},success:function(t){"success"===t.status?(a.remove().draw(!1),$.notify({message:t.message},{type:"success"})):$.notify({message:t.message},{type:"danger"})}})},init(){this.get(),$("#groupCreateForm").on("submit",function(a){a.preventDefault(),groupApp.create($(this).serializeArray())}),$("#groupTable tbody").on("click","div.action-link",function(){let a=groupApp.dataTable.row($(this).parents("tr"));groupApp.show(a)}),$("#groupTable tbody").on("click","div.action-delete",function(){let a=groupApp.dataTable.row($(this).parents("tr"));a.data().trans+a.data().not_trans>0?($("#groupDeleteModal").modal("show"),$('#groupDeleteModal button[type="submit"]').on("click",function(t){$("#groupDeleteModal").modal("hide"),groupApp.delete(a)})):groupApp.delete(a)}),$("#groupSearchForm").on("submit",function(a){a.preventDefault(),groupApp.searchText=$(this).find("input").val(),groupApp.dataTable.draw()})}},transApp={dataTable:{},url:{},dict:{},group:null,keyText:null,translationText:null,verified:null,translated:null,langs:{},get(){this.dataTable=$("#transTable").DataTable({processing:!0,serverSide:!0,searching:!1,stateSave:!0,scrollX:200,order:[[0,"desc"]],ajax:{url:transApp.url.get,data:function(a){a.group_id=transApp.group,a.keyText=transApp.keyText,a.translationText=transApp.translationText,a.verified=transApp.verified,a.translated=transApp.translated,a.langs=Object.keys(transApp.langs)}},columns:transApp.columns(),drawCallback:function(a){$('[data-toggle="tooltip"]').tooltip()}})},create(a){$.ajax({type:"POST",url:transApp.url.store,data:a,success:function(a){"success"===a.status?(transApp.dataTable.ajax.reload(),$.notify({message:a.message},{type:"success"})):$.notify({message:a.message},{type:"danger"})},error:function(a){$.notify({message:a.message},{type:"danger"})}})},update(a,t){$.ajax({type:"PATCH",url:transApp.url.update,data:a,success:function(a){"success"===a.status?(transApp.dataTable.ajax.reload(null,!1),t.modal("hide"),$.notify({message:a.message},{type:"success"})):$.notify({message:a.message},{type:"danger"})}})},delete(a,t){$.ajax({type:"DELETE",url:transApp.url.destroy,data:a,success:function(a){"success"===a.status?(transApp.dataTable.ajax.reload(null,!1),t.modal("hide"),$.notify({message:a.message},{type:"success"})):$.notify({message:a.message},{type:"danger"})}})},columns(){let a=[];a.push({data:"key",title:"Key",width:"180px",render:function(a,t,e,n){return'<div class="form-control field key-field" >'+a+'</div> <div class="dropdown-toggle key" id="dropdownMenuButton" data-toggle="tooltip" title="'+e.description+'"></div>'}});for(let t in transApp.langs)a.push({data:"items._"+t,title:transApp.langs[t],width:"180px",orderable:!1,render:function(a,e,n,s){let r="",l="td-default";return a&&(r=a.translation||"",l=2===a.status?"td-aproved":1===a.status?"td-warning":"td-default"),'<div data-lang="'+t+'" class="translate form-control field '+l+'">'+r+"</div>"}});return a},init(){this.get(),$("#transCreateForm").on("submit",function(a){a.preventDefault(),transApp.create($(this).serializeArray())}),$("#transTable tbody").on("click",".dropdown-toggle",function(){let a=transApp.dataTable.row($(this).parents("tr")).data();$(this).hasClass("key")&&($('#keyEditForm [name="id"]').val(a.id),$('#keyEditForm [name="key"]').val(a.key),$('#keyEditForm [name="description"]').val(a.description),$("#keyEditModal").modal())}),$("#transTable tbody").on("click",".translate",function(){let a=transApp.dataTable.row($(this).parents("tr")).data(),t=$(this).data("lang"),e=a.items["_"+t]?a.items["_"+t].translation:"";$('#tranlateEditForm [name="key"]').val(a.id),$('#tranlateEditForm [name="lang"]').val(t),$('#tranlateEditForm [name="translation"]').val(e),$("#tranlateEditModal").modal()}),$('#keyEditForm button[type="submit"]').on("click",function(a){a.preventDefault(),transApp.update($(this).closest("form").serializeArray(),$("#keyEditModal"))}),$('#tranlateEditForm button[type="submit"]').on("click",function(a){a.preventDefault();let t=$(this).closest("form").serializeArray();t.push({name:"status",value:$(this).val()}),transApp.update(t,$("#tranlateEditModal"))}),$("#verifyOptions input").on("click",function(){transApp.verified=$(this).val(),transApp.dataTable.draw()}),$("#translateOptions input").on("click",function(){transApp.translated=$(this).val(),transApp.dataTable.draw()}),$("#langOptions input").on("click",function(){let a={};$("#langOptions input:checked").each(function(t,e){a[e.value]=transApp.langs[e.value]}),transApp.langs=0===Object.keys(a).length?transApp.langs:a,transApp.dataTable.clear().destroy(),$("#transTable tr").remove(),transApp.get()}),$("#searchFilter").on("submit",function(a){a.preventDefault(),transApp.keyText=$(this).find('[name="key"]').val(),transApp.translationText=$(this).find('[name="translation"]').val(),transApp.dataTable.draw()}),$(".accordion-header").on("click",function(a){a.preventDefault(),a.stopPropagation(),$(this).parent().find(".accordion-body").toggleClass("show-options")}),$("#searchLangFilter").on("keyup",function(a){let t=$("#langOptions .form-check"),e=this.value,n=e.charAt(0).toUpperCase()+e.slice(1);t.hide(),""!==e?t.each(function(a,t){($(t).data("lang").match(e+".*")||$(t).data("lang").match(n+".*"))&&$(t).show()}):t.show()})}};$(function(a){a('.modal-dialog button[name="cancel"]').on("click",function(){a(this).closest(".modal").modal("hide")})});
